[general]
clearglobalvars=yes

[globals]
DIAL_TIMEOUT = 100
TRUNK_OPTS = T
DIAL_OPTS = t

;исходящие звонки, звонки, которые совершают наши пользователи
; ARG1 - extension, ARG2 - channel (ip{tel}), DIAL_TIMEOUT - таймаут, ARG3 - dial flags
[macro-out1]
exten => s,1,Noop(out1-start)
exten => s,n,Noop(Try ch1)
exten => s,n,Macro(dialc_g,${ARG1},ip1903_1,${ARG3})
exten => s,n,Noop(Try ch2)
exten => s,n,Macro(dialc_g,${ARG1},ip1903_2,${ARG3})
exten => s,n,Noop(Try ch3)
exten => s,n,Macro(dialc_g,${ARG1},ip1903_3,${ARG3})
exten => s,n,Noop(Try ch4)
exten => s,n,Macro(dialc_g,${ARG1},ip1903_4,${ARG3})
exten => s,n,Noop(Try ch old ch)
exten => s,n,Macro(dialc_g,${ARG1},${ARG2},${ARG3})
exten => s,n,Busy

[macro-deny]
exten => s,1,Noop(deny all calls)
exten => s,n,Busy

; ARG1 - extension, ARG2 - channel (ip{tel}), DIAL_TIMEOUT - таймаут, ARG3 - dial flags
[macro-dialc_g]
exten => s,1,Noop(startdial ${ARG1} ${ARG2} ${ARG3})
exten => s,n,Set(fname=${CALLERID(num)}-${ARG2}-${ARG1}-${UNIQUEID}-g)
exten => s,n,Noop(${fname})
exten => s,n,MixMonitor(/var/calls/${fname}.wav,ab)
exten => s,n(startdial),Dial(SIP/${ARG2}/${ARG1},${DIAL_TIMEOUT},${ARG3})
exten => s,n,Goto(s-${DIALSTATUS},1)
exten => s,n(end),Noop(Fail failed)

exten => s-BUSY,1,Noop(Busy. Hangup)
exten => s-BUSY,n,Hangup

exten => _s-.,1,Noop(Next channel)

; ====={out_context _X. ...тут указываются правила для исходящей связи

; internal => [user:2:degunino] => [peer:5:p9677581_5] => Internet
[c9677581_5]
exten => _9[1-79]X.,1,Noop(degunino-external-ip9677581_5)
exten => _9[1-79]X.,n,Macro(dialc,${EXTEN:1},ip9677581_5,${TRUNK_OPTS})
exten => _9[1-79]X.,n,Busy
exten => _849[59]X.,1,Noop(degunino-external-ip9677581_5)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip9677581_5,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(degunino-external-ip9677581_5)
exten => _8X.,n,Macro(out1,${EXTEN},ip9677581_5,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _98X.,1,Noop(degunino-external-ip9677581_5)
exten => _98X.,n,Macro(out1,${EXTEN:1},ip9677581_5,${TRUNK_OPTS})
exten => _98X.,n,Busy
exten => _9XXXXXX,1,Noop(degunino-external-ip9677581_5)
exten => _9XXXXXX,n,Macro(dialc,${EXTEN},ip9677581_5,${TRUNK_OPTS})
exten => _9XXXXXX,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581_5,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581_5]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581_5/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:2:degunino] => [peer:6:p9677581_6] => Internet
[c9677581_6]
exten => _9[1-79]X.,1,Noop(degunino-external-ip9677581_6)
exten => _9[1-79]X.,n,Macro(dialc,${EXTEN:1},ip9677581_6,${TRUNK_OPTS})
exten => _9[1-79]X.,n,Busy
exten => _849[59]X.,1,Noop(degunino-external-ip9677581_6)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip9677581_6,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(degunino-external-ip9677581_6)
exten => _8X.,n,Macro(out1,${EXTEN},ip9677581_6,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _98X.,1,Noop(degunino-external-ip9677581_6)
exten => _98X.,n,Macro(out1,${EXTEN:1},ip9677581_6,${TRUNK_OPTS})
exten => _98X.,n,Busy
exten => _9XXXXXX,1,Noop(degunino-external-ip9677581_6)
exten => _9XXXXXX,n,Macro(dialc,${EXTEN},ip9677581_6,${TRUNK_OPTS})
exten => _9XXXXXX,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581_6,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581_6]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581_6/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:2:degunino] => [peer:40:p9677581_40] => Internet
[c9677581_40]
exten => _9[1-79]X.,1,Noop(degunino-external-ip9677581_40)
exten => _9[1-79]X.,n,Macro(dialc,${EXTEN:1},ip9677581_40,${TRUNK_OPTS})
exten => _9[1-79]X.,n,Busy
exten => _849[59]X.,1,Noop(degunino-external-ip9677581_40)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip9677581_40,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(degunino-external-ip9677581_40)
exten => _8X.,n,Macro(out1,${EXTEN},ip9677581_40,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _98X.,1,Noop(degunino-external-ip9677581_40)
exten => _98X.,n,Macro(out1,${EXTEN:1},ip9677581_40,${TRUNK_OPTS})
exten => _98X.,n,Busy
exten => _9XXXXXX,1,Noop(degunino-external-ip9677581_40)
exten => _9XXXXXX,n,Macro(dialc,${EXTEN},ip9677581_40,${TRUNK_OPTS})
exten => _9XXXXXX,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581_40,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581_40]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581_40/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:2:degunino] => [peer:41:p9677581_41] => Internet
[c9677581_41]
exten => _9[1-79]X.,1,Noop(degunino-external-ip9677581_41)
exten => _9[1-79]X.,n,Macro(dialc,${EXTEN:1},ip9677581_41,${TRUNK_OPTS})
exten => _9[1-79]X.,n,Busy
exten => _849[59]X.,1,Noop(degunino-external-ip9677581_41)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip9677581_41,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(degunino-external-ip9677581_41)
exten => _8X.,n,Macro(out1,${EXTEN},ip9677581_41,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _98X.,1,Noop(degunino-external-ip9677581_41)
exten => _98X.,n,Macro(out1,${EXTEN:1},ip9677581_41,${TRUNK_OPTS})
exten => _98X.,n,Busy
exten => _9XXXXXX,1,Noop(degunino-external-ip9677581_41)
exten => _9XXXXXX,n,Macro(dialc,${EXTEN},ip9677581_41,${TRUNK_OPTS})
exten => _9XXXXXX,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581_41,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581_41]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581_41/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:2:degunino] => [peer:42:p9677581_42] => Internet
[c9677581_42]
exten => _9[1-79]X.,1,Noop(degunino-external-ip9677581_42)
exten => _9[1-79]X.,n,Macro(dialc,${EXTEN:1},ip9677581_42,${TRUNK_OPTS})
exten => _9[1-79]X.,n,Busy
exten => _849[59]X.,1,Noop(degunino-external-ip9677581_42)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip9677581_42,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(degunino-external-ip9677581_42)
exten => _8X.,n,Macro(out1,${EXTEN},ip9677581_42,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _98X.,1,Noop(degunino-external-ip9677581_42)
exten => _98X.,n,Macro(out1,${EXTEN:1},ip9677581_42,${TRUNK_OPTS})
exten => _98X.,n,Busy
exten => _9XXXXXX,1,Noop(degunino-external-ip9677581_42)
exten => _9XXXXXX,n,Macro(dialc,${EXTEN},ip9677581_42,${TRUNK_OPTS})
exten => _9XXXXXX,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581_42,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581_42]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581_42/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:11:phone_autoterm] => [peer:12:p6639958_12] => Internet
[c6639958_12]
exten => _8X.,1,Noop(phone_autoterm-external-ip6639958_12)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639958_12,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_autoterm-external-ip6639958_12)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639958_12,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6639958_12,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6639958_12]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6639958_12/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:6:phone_exmast] => [peer:13:p6639982_13] => Internet
[c6639982_13]
exten => _8X.,1,Noop(phone_exmast-external-ip6639982_13)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639982_13,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6639982_13,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6639982_13]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6639982_13/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:9:phone_yan] => [peer:7:p6639983_7] => Internet
[c6639983_7]
exten => _8X.,1,Noop(phone_yan-external-ip6639983_7)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639983_7,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_yan-external-ip6639983_7)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639983_7,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6639983_7,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6639983_7]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6639983_7/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:1:test] => [peer:32:test] => Internet
[ctest]
exten => 101,1,Noop(test-internal-10076)
exten => 101,n(startdial),Dial(SIP/10076,100,tT)
exten => 101,n,Busy
exten => 102,1,Noop(test-internal-10077)
exten => 102,n(startdial),Dial(SIP/10077,100,tT)
exten => 102,n,Busy
exten => _8X.,1,Noop(test-external-iptest)
exten => _8X.,n,Macro(out1,${EXTEN},iptest,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},iptest,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialctest]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/iptest/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:1:test] => [peer:33:sipnet_calc] => Internet
[c0028513669]
exten => _X.,1,Macro(dialc,${EXTEN},ip0028513669,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc0028513669]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip0028513669/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:8:phone_azbuka] => [peer:21:p6385396_21] => Internet
[c6385396_21]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385396_21,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385396_21]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385396_21/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:8:phone_azbuka] => [peer:22:p6385586_22] => Internet
[c6385586_22]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385586_22,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385586_22]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385586_22/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:10:phone_atomic] => [peer:64:p6637453_64] => Internet
[c6637453_64]
exten => _8X.,1,Noop(phone_atomic-external-ip6637453_64)
exten => _8X.,n,Macro(out1,${EXTEN},ip6637453_64,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_atomic-external-ip6637453_64)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6637453_64,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6637453_64,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6637453_64]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6637453_64/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:10:phone_atomic] => [peer:65:p6637453_65] => Internet
[c6637453_65]
exten => _8X.,1,Noop(phone_atomic-external-ip6637453_65)
exten => _8X.,n,Macro(out1,${EXTEN},ip6637453_65,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_atomic-external-ip6637453_65)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6637453_65,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6637453_65,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6637453_65]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6637453_65/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:10:phone_atomic] => [peer:77:p6637453_77] => Internet
[c6637453_77]
exten => _8X.,1,Noop(phone_atomic-external-ip6637453_77)
exten => _8X.,n,Macro(out1,${EXTEN},ip6637453_77,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_atomic-external-ip6637453_77)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6637453_77,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6637453_77,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6637453_77]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6637453_77/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:10:phone_atomic] => [peer:34:p6467815_34] => Internet
[c6467815_34]
exten => _8X.,1,Noop(phone_atomic-external-ip6467815_34)
exten => _8X.,n,Macro(out1,${EXTEN},ip6467815_34,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_atomic-external-ip6467815_34)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6467815_34,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6467815_34,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6467815_34]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6467815_34/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:10:phone_atomic] => [peer:15:p6637453_15] => Internet
[c6637453_15]
exten => _8X.,1,Noop(phone_atomic-external-ip6637453_15)
exten => _8X.,n,Macro(out1,${EXTEN},ip6637453_15,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_atomic-external-ip6637453_15)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6637453_15,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6637453_15,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6637453_15]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6637453_15/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:13:phone_diskom] => [peer:27:p6637465_27] => Internet
[c6637465_27]
exten => _8X.,1,Noop(phone_diskom-external-ip6637465_27)
exten => _8X.,n,Macro(out1,${EXTEN},ip6637465_27,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_diskom-external-ip6637465_27)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6637465_27,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6637465_27,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6637465_27]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6637465_27/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:13:phone_diskom] => [peer:26:p6637472_26] => Internet
[c6637472_26]
exten => _8X.,1,Noop(phone_diskom-external-ip6637472_26)
exten => _8X.,n,Macro(out1,${EXTEN},ip6637472_26,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(phone_diskom-external-ip6637472_26)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6637472_26,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6637472_26,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6637472_26]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6637472_26/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:19:opl_1] => [peer:53:p6385126_53] => Internet
[c6385126_53]
exten => 103,1,Noop(opl_1-internal-10192)
exten => 103,n(startdial),Dial(SIP/10192,100,tT)
exten => 103,n,Busy
exten => 101,1,Noop(opl_1-internal-10190)
exten => 101,n(startdial),Dial(SIP/10190,100,tT)
exten => 101,n,Busy
exten => 102,1,Noop(opl_1-internal-10191)
exten => 102,n(startdial),Dial(SIP/10191,100,tT)
exten => 102,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6385126_53,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385126_53]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385126_53/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:21:acid] => [peer:24:deg_acid] => Internet
[c9677581acid]
exten => _98X.,1,Noop(acid-external-ip9677581acid)
exten => _98X.,n,Macro(out1,${EXTEN:1},ip9677581acid,${TRUNK_OPTS})
exten => _98X.,n,Busy
exten => _9849[59]X.,1,Noop(acid-external-ip9677581acid)
exten => _9849[59]X.,n,Macro(dialc,${EXTEN:1},ip9677581acid,${TRUNK_OPTS})
exten => _9849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581acid,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581acid]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581acid/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:24:Исходящая связь] => [peer:31:mcn1] => Internet
[c1903_1]
exten => _X.,1,Macro(dialc,${EXTEN},ip1903_1,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc1903_1]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip1903_1/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:24:Исходящая связь] => [peer:28:mcn2] => Internet
[c1903_2]
exten => _X.,1,Macro(dialc,${EXTEN},ip1903_2,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc1903_2]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip1903_2/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:24:Исходящая связь] => [peer:29:mcn3] => Internet
[c1903_3]
exten => _X.,1,Macro(dialc,${EXTEN},ip1903_3,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc1903_3]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip1903_3/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:26:zebra] => [peer:14:p6639986_14] => Internet
[c6639986_14]
exten => _849[59]X.,1,Noop(zebra-external-ip6639986_14)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639986_14,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _849[59]X.,1,Noop(zebra-external-ip6639986_14)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639986_14,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(zebra-external-ip6639986_14)
exten => _8X.,n,Macro(deny,${EXTEN},ip6639986_14,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6639986_14,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6639986_14]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6639986_14/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:28:opl_2] => [peer:35:p6467816_35] => Internet
[c6467816_35]
exten => _849[59]X.,1,Noop(opl_2-external-ip6467816_35)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6467816_35,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(opl_2-external-ip6467816_35)
exten => _8X.,n,Macro(out1,${EXTEN},ip6467816_35,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6467816_35,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6467816_35]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6467816_35/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:29:nikolos] => [peer:36:deg_nikolos] => Internet
[c9677581nik]
exten => _8X.,1,Noop(nikolos-external-ip9677581nik)
exten => _8X.,n,Macro(out1,${EXTEN},ip9677581nik,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip9677581nik,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677581nik]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677581nik/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:30:hzkto1] => [peer:37:p6385097_37] => Internet
[c6385097_37]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385097_37,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385097_37]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385097_37/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:31:degunino_fax] => [peer:30:mcn4] => Internet
[c1903_4]
exten => _8X.,1,Noop(degunino_fax-external-ip1903_4)
exten => _8X.,n,Macro(out1,${EXTEN},ip1903_4,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip1903_4,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc1903_4]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip1903_4/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:32:smartbox] => [peer:38:p6385041_38] => Internet
[c6385041_38]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385041_38,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385041_38]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385041_38/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:32:smartbox] => [peer:39:p6385042_39] => Internet
[c6385042_39]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385042_39,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385042_39]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385042_39/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:32:smartbox] => [peer:67:p6385043_67] => Internet
[c6385043_67]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385043_67,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385043_67]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385043_67/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:34:nitro_test] => [peer:45:nitro_test] => Internet
[cnitro_test]
exten => _849[59]X.,1,Noop(nitro_test-external-ipnitro_test)
exten => _849[59]X.,n,Macro(deny,${EXTEN},ipnitro_test,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(nitro_test-external-ipnitro_test)
exten => _8X.,n,Macro(out1,${EXTEN},ipnitro_test,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => 101,1,Noop(nitro_test-internal-10341)
exten => 101,n(startdial),Dial(SIP/10341,100,tT)
exten => 101,n,Busy
exten => 102,1,Noop(nitro_test-internal-10342)
exten => 102,n(startdial),Dial(SIP/10342,100,tT)
exten => 102,n,Busy
exten => 103,1,Noop(nitro_test-internal-10343)
exten => 103,n(startdial),Dial(SIP/10343,100,tT)
exten => 103,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ipnitro_test,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialcnitro_test]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ipnitro_test/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:35:kuznecov] => [peer:20:p6639985_20] => Internet
[c6639985_20]
exten => _849[59]X.,1,Noop(kuznecov-external-ip6639985_20)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639985_20,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(kuznecov-external-ip6639985_20)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639985_20,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _8X.,1,Noop(kuznecov-external-ip6639985_20)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639985_20,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(kuznecov-external-ip6639985_20)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639985_20,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6639985_20,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6639985_20]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6639985_20/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:36:afex] => [peer:46:p6385574_46] => Internet
[c6385574_46]
exten => _8X.,1,Noop(afex-external-ip6385574_46)
exten => _8X.,n,Macro(out1,${EXTEN},ip6385574_46,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(afex-external-ip6385574_46)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6385574_46,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6385574_46,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385574_46]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385574_46/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:37:opl_3] => [peer:47:p6385453_47] => Internet
[c6385453_47]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385453_47,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385453_47]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385453_47/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:38:opl_4] => [peer:48:p6385259_48] => Internet
[c6385259_48]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385259_48,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385259_48]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385259_48/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:39:opl_5] => [peer:49:p6385627_49] => Internet
[c6385627_49]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385627_49,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385627_49]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385627_49/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:39:opl_5] => [peer:61:p6385627_61] => Internet
[c6385627_61]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385627_61,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385627_61]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385627_61/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:39:opl_5] => [peer:62:p6385627_62] => Internet
[c6385627_62]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385627_62,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385627_62]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385627_62/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:41:opl_6] => [peer:58:p6385256_58] => Internet
[c6385256_58]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385256_58,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385256_58]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385256_58/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:43:olegr] => [peer:60:p7218741_60] => Internet
[c7218741_60]
exten => _X.,1,Macro(dialc,${EXTEN},ip7218741_60,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc7218741_60]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip7218741_60/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:45:munai] => [peer:10:p7218798_10] => Internet
[c7218798_10]
exten => _849[59]X.,1,Noop(munai-external-ip7218798_10)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip7218798_10,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(munai-external-ip7218798_10)
exten => _8X.,n,Macro(out1,${EXTEN},ip7218798_10,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => 101,1,Noop(munai-internal-10450)
exten => 101,n(startdial),Dial(SIP/10450,100,tT)
exten => 101,n,Busy
exten => 102,1,Noop(munai-internal-10451)
exten => 102,n(startdial),Dial(SIP/10451,100,tT)
exten => 102,n,Busy
exten => 103,1,Noop(munai-internal-10452)
exten => 103,n(startdial),Dial(SIP/10452,100,tT)
exten => 103,n,Busy
exten => 104,1,Noop(munai-internal-10453)
exten => 104,n(startdial),Dial(SIP/10453,100,tT)
exten => 104,n,Busy
exten => 105,1,Noop(munai-internal-10454)
exten => 105,n(startdial),Dial(SIP/10454,100,tT)
exten => 105,n,Busy
exten => 106,1,Noop(munai-internal-10455)
exten => 106,n(startdial),Dial(SIP/10455,100,tT)
exten => 106,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip7218798_10,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc7218798_10]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip7218798_10/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:46:bravopak] => [peer:68:p499685-1801_68] => Internet
[c499685-1801_68]
exten => _X.,1,Macro(dialc,${EXTEN},ip499685-1801_68,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc499685-1801_68]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip499685-1801_68/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:52:golf] => [peer:11:p6639975_11] => Internet
[c6639975_11]
exten => _8X.,1,Noop(golf-external-ip6639975_11)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639975_11,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _849[59]X.,1,Noop(golf-external-ip6639975_11)
exten => _849[59]X.,n,Macro(dialc,${EXTEN},ip6639975_11,${TRUNK_OPTS})
exten => _849[59]X.,n,Busy
exten => _8X.,1,Noop(golf-external-ip6639975_11)
exten => _8X.,n,Macro(out1,${EXTEN},ip6639975_11,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip6639975_11,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6639975_11]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6639975_11/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:53:oleg] => [peer:44:p9677595_44] => Internet
[c9677595_44]
exten => _X.,1,Macro(dialc,${EXTEN},ip9677595_44,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677595_44]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677595_44/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:53:oleg] => [peer:43:p9677595_43] => Internet
[c9677595_43]
exten => _X.,1,Macro(dialc,${EXTEN},ip9677595_43,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc9677595_43]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip9677595_43/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:54:atsp] => [peer:8:p7218720_8] => Internet
[c7218720_8]
exten => _8X.,1,Noop(atsp-external-ip7218720_8)
exten => _8X.,n,Macro(out1,${EXTEN},ip7218720_8,${TRUNK_OPTS})
exten => _8X.,n,Busy
exten => _8X.,1,Noop(atsp-external-ip7218720_8)
exten => _8X.,n,Macro(out1,${EXTEN},ip7218720_8,${TRUNK_OPTS})
exten => _8X.,n,Busy

exten => _X.,1,Macro(dialc,${EXTEN},ip7218720_8,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc7218720_8]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip7218720_8/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:55:ruben] => [peer:69:p6385589_69] => Internet
[c6385589_69]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385589_69,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385589_69]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385589_69/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:57:opl_8] => [peer:71:p7499213-04-34_71] => Internet
[c7499213-04-34_71]
exten => _X.,1,Macro(dialc,${EXTEN},ip7499213-04-34_71,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc7499213-04-34_71]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip7499213-04-34_71/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:57:opl_8] => [peer:72:p7499213-04-34_72] => Internet
[c7499213-04-34_72]
exten => _X.,1,Macro(dialc,${EXTEN},ip7499213-04-34_72,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc7499213-04-34_72]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip7499213-04-34_72/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:58:transgruz] => [peer:73:p74992130301_73] => Internet
[c74992130301_73]
exten => _X.,1,Macro(dialc,${EXTEN},ip74992130301_73,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc74992130301_73]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip74992130301_73/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:58:transgruz] => [peer:74:p74992130301_74] => Internet
[c74992130301_74]
exten => _X.,1,Macro(dialc,${EXTEN},ip74992130301_74,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc74992130301_74]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip74992130301_74/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:58:transgruz] => [peer:75:p74992130302_75] => Internet
[c74992130302_75]
exten => _X.,1,Macro(dialc,${EXTEN},ip74992130302_75,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc74992130302_75]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip74992130302_75/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:58:transgruz] => [peer:76:p74992130302_76] => Internet
[c74992130302_76]
exten => _X.,1,Macro(dialc,${EXTEN},ip74992130302_76,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc74992130302_76]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip74992130302_76/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; internal => [user:59:volvo] => [peer:78:p6385448_78] => Internet
[c6385448_78]
exten => _X.,1,Macro(dialc,${EXTEN},ip6385448_78,${TRUNK_OPTS})
exten => _X.,n,Busy
;; 
;;[macro-dialc6385448_78]
;;exten => s,1,Goto(startdial)
;;exten => s,n(startdial),Dial(SIP/ip6385448_78/${ARG1},100,T)
;;exten => s,n,Noop(Fail failed)

; =====out_context}

; Общий макрос для исходящих звонков, в CDR указывается вызывающий его контекст
; ARG1 - extension, ARG2 - channel (ip{tel}), DIAL_TIMEOUT - таймаут, ARG3 - dial flags
[macro-dialc]
exten => s,1,Noop(startdial)
exten => s,n,Set(fname=${CALLERID(num)}-${ARG2}-${ARG1}-${UNIQUEID})
exten => s,n,Noop(${fname})
exten => s,n,MixMonitor(/var/calls/${fname}.wav,ab)
exten => s,n(startdial),Dial(SIP/${ARG2}/${ARG1},100,${ARG3})
exten => s,n,Noop(Fail failed)

;входящие звонки, заводим все звонки в общий контекст
[inbound]
exten => 1001400,1,Noop(degunino-p9677581_5)
exten => 1001400,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1001400,n,Macro(dialip,SIP/10020,t,${EXTEN},c9677581_5)
exten => 1001400,n,Hangup(17)
exten => 1001401,1,Noop(degunino-p9677581_6)
exten => 1001401,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1001401,n,Macro(dialip,SIP/10021,t,${EXTEN},c9677581_6)
exten => 1001401,n,Hangup(17)
exten => 1023241,1,Noop(degunino-p9677581_40)
exten => 1023241,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1023241,n,Macro(dialip,SIP/10022,t,${EXTEN},c9677581_40)
exten => 1023241,n,Hangup(17)
exten => 1023242,1,Noop(degunino-p9677581_41)
exten => 1023242,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1023242,n,Macro(dialip,SIP/10023,t,${EXTEN},c9677581_41)
exten => 1023242,n,Hangup(17)
exten => 1023243,1,Noop(degunino-p9677581_42)
exten => 1023243,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1023243,n,Macro(dialip,SIP/10024,t,${EXTEN},c9677581_42)
exten => 1023243,n,Hangup(17)
exten => 1006520,1,Noop(phone_autoterm-p6639958_12)
exten => 1006520,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1006520,n,Macro(dialip,SIP/10065200,t,${EXTEN},c6639958_12)
exten => 1006520,n,Hangup(17)
exten => 1007460,1,Noop(phone_exmast-p6639982_13)
exten => 1007460,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1007460,n,Macro(dialip,SIP/10064&SIP/10074600,t,${EXTEN},c6639982_13)
exten => 1007460,n,Hangup(17)
exten => 1007480,1,Noop(phone_yan-p6639983_7)
exten => 1007480,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1007480,n,Macro(dialip,SIP/100748,t,${EXTEN},c6639983_7)
exten => 1007480,n,Hangup(17)
exten => test,1,Noop(test-test)
exten => test,n,Set(CALLERID(name)=${CALLERID(num)})
exten => test,n,Macro(dialip,SIP/10076,t,${EXTEN},ctest)
exten => test,n,Hangup(17)
exten => 0028513669,1,Noop(test-sipnet_calc)
exten => 0028513669,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 0028513669,n,Macro(dialip,SIP/10077,t,${EXTEN},c0028513669)
exten => 0028513669,n,Hangup(17)
exten => 74956385396*1,1,Noop(phone_azbuka-p6385396_21)
exten => 74956385396*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385396*1,n,Macro(dialip,SIP/10080,t,${EXTEN},c6385396_21)
exten => 74956385396*1,n,Hangup(17)
exten => 74956385586*1,1,Noop(phone_azbuka-p6385586_22)
exten => 74956385586*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385586*1,n,Macro(dialip,SIP/10085,t,${EXTEN},c6385586_22)
exten => 74956385586*1,n,Hangup(17)
exten => 1012121,1,Noop(phone_atomic-p6637453_64)
exten => 1012121,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1012121,n,Macro(dialip,SIP/10103,t,${EXTEN},c6637453_64)
exten => 1012121,n,Hangup(17)
exten => 1033100,1,Noop(phone_atomic-p6637453_65)
exten => 1033100,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1033100,n,Macro(dialip,SIP/10104,t,${EXTEN},c6637453_65)
exten => 1033100,n,Hangup(17)
exten => 1102964,1,Noop(phone_atomic-p6637453_77)
exten => 1102964,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1102964,n,Macro(dialip,SIP/10105,t,${EXTEN},c6637453_77)
exten => 1102964,n,Hangup(17)
exten => 1020540,1,Noop(phone_atomic-p6467815_34)
exten => 1020540,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1020540,n,Macro(dialip,SIP/10106,t,${EXTEN},c6467815_34)
exten => 1020540,n,Hangup(17)
exten => 1012120,1,Noop(phone_atomic-p6637453_15)
exten => 1012120,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1012120,n,Macro(dialip,SIP/10102&SIP/10121200,t,${EXTEN},c6637453_15)
exten => 1012120,n,Hangup(17)
exten => 1005520,1,Noop(phone_diskom-p6637465_27)
exten => 1005520,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1005520,n,Macro(dialip,SIP/10130,t,${EXTEN},c6637465_27)
exten => 1005520,n,Hangup(17)
exten => 1005540,1,Noop(phone_diskom-p6637472_26)
exten => 1005540,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1005540,n,Macro(dialip,SIP/10131,t,${EXTEN},c6637472_26)
exten => 1005540,n,Hangup(17)
exten => 74956385126*1,1,Noop(opl_1-p6385126_53)
exten => 74956385126*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385126*1,n,Macro(dialip,SIP/10190&SIP/10191&SIP/10192&SIP/11111,t,${EXTEN},c6385126_53)
exten => 74956385126*1,n,Hangup(17)
exten => 100004,1,Noop(acid-deg_acid)
exten => 100004,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 100004,n,Macro(dialip,SIP/10210,t,${EXTEN},c9677581acid)
exten => 100004,n,Hangup(17)
exten => id81421,1,Noop(Исходящая связь-mcn1)
exten => id81421,n,Set(CALLERID(name)=${CALLERID(num)})
exten => id81421,n,Macro(dialip,SIP/10241,t,${EXTEN},c1903_1)
exten => id81421,n,Hangup(17)
exten => id81422,1,Noop(Исходящая связь-mcn2)
exten => id81422,n,Set(CALLERID(name)=${CALLERID(num)})
exten => id81422,n,Macro(dialip,SIP/10242,t,${EXTEN},c1903_2)
exten => id81422,n,Hangup(17)
exten => id81423,1,Noop(Исходящая связь-mcn3)
exten => id81423,n,Set(CALLERID(name)=${CALLERID(num)})
exten => id81423,n,Macro(dialip,SIP/10243,t,${EXTEN},c1903_3)
exten => id81423,n,Hangup(17)
exten => 1008640,1,Noop(zebra-p6639986_14)
exten => 1008640,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1008640,n,Macro(dialip,SIP/10260,t,${EXTEN},c6639986_14)
exten => 1008640,n,Hangup(17)
exten => 1020860,1,Noop(opl_2-p6467816_35)
exten => 1020860,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1020860,n,Macro(dialip,SIP/10280&SIP/10281,t,${EXTEN},c6467816_35)
exten => 1020860,n,Hangup(17)
exten => 10000411,1,Noop(nikolos-deg_nikolos)
exten => 10000411,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 10000411,n,Macro(dialip,SIP/10290,t,${EXTEN},c9677581nik)
exten => 10000411,n,Hangup(17)
exten => 74956385097*1,1,Noop(hzkto1-p6385097_37)
exten => 74956385097*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385097*1,n,Macro(dialip,SIP/10301&SIP/10302,t,${EXTEN},c6385097_37)
exten => 74956385097*1,n,Hangup(17)
exten => id81424,1,Noop(degunino_fax-mcn4)
exten => id81424,n,Set(CALLERID(name)=${CALLERID(num)})
exten => id81424,n,Macro(dialip,SIP/10312&SIP/10313&SIP/10314&SIP/10315,t,${EXTEN},c1903_4)
exten => id81424,n,Hangup(17)
exten => 74956385041*1,1,Noop(smartbox-p6385041_38)
exten => 74956385041*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385041*1,n,Macro(dialip,SIP/10321&SIP/10322&SIP/10323,t,${EXTEN},c6385041_38)
exten => 74956385041*1,n,Hangup(17)
exten => 74956385042*1,1,Noop(smartbox-p6385042_39)
exten => 74956385042*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385042*1,n,Macro(dialip,SIP/10324&SIP/10325,t,${EXTEN},c6385042_39)
exten => 74956385042*1,n,Hangup(17)
exten => 74956385043*1,1,Noop(smartbox-p6385043_67)
exten => 74956385043*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385043*1,n,Macro(dialip,SIP/10326&SIP/10327,t,${EXTEN},c6385043_67)
exten => 74956385043*1,n,Hangup(17)
exten => nitro_test,1,Noop(nitro_test-nitro_test)
exten => nitro_test,n,Set(CALLERID(name)=${CALLERID(num)})
exten => nitro_test,n,Macro(dialip,SIP/10341&SIP/10342&SIP/10343,t,${EXTEN},cnitro_test)
exten => nitro_test,n,Hangup(17)
exten => 1007660,1,Noop(kuznecov-p6639985_20)
exten => 1007660,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1007660,n,Macro(dialip,SIP/10350,t,${EXTEN},c6639985_20)
exten => 1007660,n,Hangup(17)
exten => 74956385574*1,1,Noop(afex-p6385574_46)
exten => 74956385574*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385574*1,n,Macro(dialip,SIP/10360,t,${EXTEN},c6385574_46)
exten => 74956385574*1,n,Hangup(17)
exten => 74956385453*1,1,Noop(opl_3-p6385453_47)
exten => 74956385453*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385453*1,n,Macro(dialip,SIP/10370,t,${EXTEN},c6385453_47)
exten => 74956385453*1,n,Hangup(17)
exten => 74956385259*1,1,Noop(opl_4-p6385259_48)
exten => 74956385259*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385259*1,n,Macro(dialip,SIP/10381&SIP/10382,t,${EXTEN},c6385259_48)
exten => 74956385259*1,n,Hangup(17)
exten => 74956385627*1,1,Noop(opl_5-p6385627_49)
exten => 74956385627*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385627*1,n,Macro(dialip,SIP/10391,t,${EXTEN},c6385627_49)
exten => 74956385627*1,n,Hangup(17)
exten => 74956385627*2,1,Noop(opl_5-p6385627_61)
exten => 74956385627*2,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385627*2,n,Macro(dialip,SIP/10392,t,${EXTEN},c6385627_61)
exten => 74956385627*2,n,Hangup(17)
exten => 74956385627*3,1,Noop(opl_5-p6385627_62)
exten => 74956385627*3,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385627*3,n,Macro(dialip,SIP/10393,t,${EXTEN},c6385627_62)
exten => 74956385627*3,n,Hangup(17)
exten => 74956385256*1,1,Noop(opl_6-p6385256_58)
exten => 74956385256*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385256*1,n,Macro(dialip,SIP/10410,t,${EXTEN},c6385256_58)
exten => 74956385256*1,n,Hangup(17)
exten => 1006100,1,Noop(olegr-p7218741_60)
exten => 1006100,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1006100,n,Macro(dialip,SIP/10430,t,${EXTEN},c7218741_60)
exten => 1006100,n,Hangup(17)
exten => 1014421,1,Noop(munai-p7218798_10)
exten => 1014421,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1014421,n,Macro(dialip,SIP/10450&SIP/10451&SIP/10452&SIP/10453&SIP/10454&SIP/10455,t,${EXTEN},c7218798_10)
exten => 1014421,n,Hangup(17)
exten => 74996851801*1,1,Noop(bravopak-p499685-1801_68)
exten => 74996851801*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74996851801*1,n,Macro(dialip,SIP/10460,t,${EXTEN},c499685-1801_68)
exten => 74996851801*1,n,Hangup(17)
exten => 1007060,1,Noop(golf-p6639975_11)
exten => 1007060,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1007060,n,Macro(dialip,SIP/10521&SIP/10522,t,${EXTEN},c6639975_11)
exten => 1007060,n,Hangup(17)
exten => 1014441,1,Noop(oleg-p9677595_44)
exten => 1014441,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1014441,n,Macro(dialip,SIP/10531,t,${EXTEN},c9677595_44)
exten => 1014441,n,Hangup(17)
exten => 1045142,1,Noop(oleg-p9677595_43)
exten => 1045142,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1045142,n,Macro(dialip,SIP/10532,t,${EXTEN},c9677595_43)
exten => 1045142,n,Hangup(17)
exten => 1014460,1,Noop(atsp-p7218720_8)
exten => 1014460,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 1014460,n,Macro(dialip,SIP/10541,t,${EXTEN},c7218720_8)
exten => 1014460,n,Hangup(17)
exten => 74956385589*1,1,Noop(ruben-p6385589_69)
exten => 74956385589*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385589*1,n,Macro(dialip,SIP/10551&SIP/10552,t,${EXTEN},c6385589_69)
exten => 74956385589*1,n,Hangup(17)
exten => 74992130434*1,1,Noop(opl_8-p7499213-04-34_71)
exten => 74992130434*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74992130434*1,n,Macro(dialip,SIP/10571,t,${EXTEN},c7499213-04-34_71)
exten => 74992130434*1,n,Hangup(17)
exten => 74992130434*2,1,Noop(opl_8-p7499213-04-34_72)
exten => 74992130434*2,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74992130434*2,n,Macro(dialip,SIP/10572,t,${EXTEN},c7499213-04-34_72)
exten => 74992130434*2,n,Hangup(17)
exten => 74992130301*1,1,Noop(transgruz-p74992130301_73)
exten => 74992130301*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74992130301*1,n,Macro(dialip,SIP/10581,t,${EXTEN},c74992130301_73)
exten => 74992130301*1,n,Hangup(17)
exten => 74992130301*2,1,Noop(transgruz-p74992130301_74)
exten => 74992130301*2,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74992130301*2,n,Macro(dialip,SIP/10582,t,${EXTEN},c74992130301_74)
exten => 74992130301*2,n,Hangup(17)
exten => 74992130302*1,1,Noop(transgruz-p74992130302_75)
exten => 74992130302*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74992130302*1,n,Macro(dialip,SIP/10585,t,${EXTEN},c74992130302_75)
exten => 74992130302*1,n,Hangup(17)
exten => 74992130302*2,1,Noop(transgruz-p74992130302_76)
exten => 74992130302*2,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74992130302*2,n,Macro(dialip,SIP/10586,t,${EXTEN},c74992130302_76)
exten => 74992130302*2,n,Hangup(17)
exten => 74956385448*1,1,Noop(volvo-p6385448_78)
exten => 74956385448*1,n,Set(CALLERID(name)=${CALLERID(num)})
exten => 74956385448*1,n,Macro(dialip,SIP/10590,t,${EXTEN},c6385448_78)
exten => 74956385448*1,n,Hangup(17)


; Общий макрос для входящих звонков, в CDR по идее указывается вызывающий контекст
;Из Internet=>peer=>[csip:inbound]=>user=>internal
; ARG1 - SIP/user, ARG2 - dial flags
[macro-dialip]
exten => s,1,Noop(dialip-default=${ARG1}-opt=${ARG2}-ext=${ARG3}-context=${ARG4})
exten => s,n,Set(default=${ARG1})
exten => s,n,Set(opt=${ARG2})
exten => s,n,Set(ext=${ARG3})
exten => s,n,Set(context=${ARG4})
exten => s,n,Set(dbkey=route/${ext})
;exten => s,n,Noop(${dbkey} exist=${DB_EXISTS(${dbkey})})
exten => s,n,GotoIf(${DB_EXISTS(${dbkey})}?startroute)
exten => s,n,Set(DB(${dbkey})=0)
exten => s,n(startroute),Set(path=${DB(${dbkey})})
exten => s,n,GotoIf($[${path}=0]?startdial)
exten => s,n,GotoIf($[${path}=1]?redirect)
exten => s,n,Goto(startdial)
exten => s,n(redirect),Noop(redirect routine for ${dbkey})
exten => s,n,GotoIf(${DB_EXISTS(${dbkey}/${path})}?:startdial)
exten => s,n,Set(callnum=${DB(${dbkey}/${path})})
exten => s,n,Noop(redirect to ${callnum})
exten => s,n,Noop(We do call to Local/${callnum}@${context})
exten => s,n,Set(fname=${CALLERID(num)}-${callnum}@${context}-${ext}-${UNIQUEID}-g)
exten => s,n,Noop(${fname})
exten => s,n,MixMonitor(/var/calls/${fname}.wav,ab)
exten => s,n,Dial(Local/${callnum}@${context},,${opt})
;exten => s,n,Goto(startdial)
exten => s,n,Goto(end)
exten => s,n(startdial),Dial(${default},,${opt})
exten => s,n(end),Noop(End macros dialip-${ext})
exten => s,n,Noop(Fail failed)

; Маршрутизация исходящих звонков в зависимости от внутренней базы данных
; /route/id
; /route/id/0	стандарн, ${ARG1}, SIP/10001&SIP/10002 и т.д.
; /route/id/1	redirect на сотовый, скорее всего на Local/89165067002@c9677581
; /route/id/2	IVR
; /route/id/3	queue
; /route/id/4	hangup?
;
;[macro-dialip]
;exten => s,1,Noop(dialip-${EXTEN})
;exten => s,n,GotoIf(DB_EXIST(route/${EXTEN})?startroute)
;exten => s,n,Set(DB(route/${EXTEN})=0)
;exten => s,n(startroute),Set(path=DB(route/${EXTEN}))
;exten => s,n,GotoIf(${path} = 0?(default))
;exten => s,n,GotoIf(${path} = 1?(redirect))
;exten => s,n(default),Noop(default)
;exten => s,n(redirect),Noop(redirect)
;exten => s,1,Goto(startdial)
;exten => s,n(startdial),Dial(${ARG1},,${ARG2})
;exten => s,n,Noop(Fail failed)
;
;
;

;; входящие звонки, звонки, которые идут с других серверов на наш
;; (Архаизм и уже не используется)

